#:import get_color_from_hex kivy.utils.get_color_from_hex

<TaskItemView>:
    size_hint_y: None
    height: dp(100)
    padding: dp(12)
    spacing: dp(8)
    radius: [dp(12)]
    elevation: 2
    ripple_behavior: True
    md_bg_color: root.background_color

    canvas.before:
        Color:
            rgba: root.background_color if root.background_color else (1, 1, 1, 1)
        RoundedRectangle:
            pos: self.pos
            size: self.size
            radius: [dp(12)]

    BoxLayout:
        orientation: "horizontal"
        spacing: dp(10)
        padding: 0

        MDCheckbox:
            active: root.completed
            on_active: root.on_checkbox_active(*args)
            size_hint: None, None
            size: dp(28), dp(28)
            pos_hint: {"center_y": 0.5}

        # --- Task Info ---
        MDBoxLayout:
            orientation: "vertical"
            spacing: dp(4)
            padding: [0, dp(6), 0, 0]

            MDLabel:
                text: root.title
                font_name: "assets/fonts/static/Cairo-Regular.ttf"
                font_style: "Subtitle1"
                bold: True
                shorten: True
                theme_text_color: "Custom"
                text_color: get_color_from_hex("#1E293B")
                halign: "left"

            MDLabel:
                text: root.description
                font_name: "assets/fonts/static/Cairo-Regular.ttf"
                font_style: "Body2"
                shorten: True
                theme_text_color: "Custom"
                text_color: get_color_from_hex("#F1F5F9")
                halign: "left"

            MDLabel:
                text: root.due_date if root.due_date else ""
                font_name: "assets/fonts/static/Cairo-Regular.ttf"
                font_style: "Caption"
                theme_text_color: "Custom"
                text_color: get_color_from_hex("#F8FAFC")
                halign: "left"

        # --- Icons Section ---
        AnchorLayout:
            anchor_x: "center"
            anchor_y: "center"
            size_hint_x: None
            width: dp(60)

            MDBoxLayout:
                orientation: "vertical"
                size_hint: None, None
                size: dp(48), dp(80)
                spacing: dp(4)

                MDIconButton:
                    icon: "pencil"
                    on_release: root.open_edit_screen()
                    theme_text_color: "Custom"
                    text_color: get_color_from_hex("#1E293B")
                    size_hint_y: None
                    height: dp(36)

                MDIconButton:
                    icon: "delete"
                    on_release: root.confirm_and_delete_task()
                    theme_text_color: "Custom"
                    text_color: get_color_from_hex("#1E293B")
                    size_hint_y: None
                    height: dp(36)